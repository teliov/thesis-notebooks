Due to the difficulty in processing the previous data export from Synthea, I've reverted to an easier solution.

The data generated is much smaller in size, exists in only one file and I do not need to do expensive joins or groupbys which is super cool!

Also with all the learning from the previous attempts at solving the initial exploration problem I am now in a much better position to make this even more solvable.

As for the other data format, I think it might be a good idea to split into intermediary stages which would basically be: get it sorted and in the same file first and then use that in the next step of the pipeline to do the necessary reductions!